# Meridian AI Worker - æ¶æ„æ–‡æ¡£

## ğŸ—ï¸ é¡¹ç›®æ¶æ„æ¦‚è§ˆ

### ğŸ“‹ é¡¹ç›®å®šä½

Meridian AI Worker æ˜¯ä¸“ä¸º Meridian æƒ…æŠ¥ç®€æŠ¥ç³»ç»Ÿè®¾è®¡çš„ AI æœåŠ¡å±‚ï¼ŒåŸºäº Cloudflare Workers æ„å»ºã€‚å®ƒä¸ºåç«¯ç³»ç»Ÿæä¾›ç»Ÿä¸€çš„ AI èƒ½åŠ›è°ƒç”¨æ¥å£ï¼ŒåŒ…æ‹¬æ–‡ç« åˆ†æã€åµŒå…¥ç”Ÿæˆã€èŠå¤©å¯¹è¯ç­‰æ ¸å¿ƒåŠŸèƒ½ã€‚

### ğŸ¯ æ ¸å¿ƒæ¶æ„æ¨¡å¼

#### åˆ†å±‚æ¶æ„
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚             HTTP æ¥å£å±‚                  â”‚  â† Hono Web Framework
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚           AI Gateway æœåŠ¡å±‚               â”‚  â† AI Gateway Service  
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚           AI æä¾›å•†é€‚é…å±‚                 â”‚  â† Provider Adapters
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚           åŸºç¡€è®¾æ–½å±‚                     â”‚  â† Cloudflare AI Gateway
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### ğŸ—‚ï¸ ç›®å½•ç»“æ„

```
src/
â”œâ”€â”€ index.ts                    # ä¸»å…¥å£ï¼ŒHTTPè·¯ç”±å®šä¹‰
â”œâ”€â”€ types.ts                    # æ ¸å¿ƒç±»å‹å®šä¹‰
â”œâ”€â”€ services/                  # æ ¸å¿ƒæœåŠ¡å±‚
â”‚   â”œâ”€â”€ ai-gateway.ts         # AI Gateway ä¸»æœåŠ¡
â”‚   â”œâ”€â”€ intelligence.ts       # æ™ºèƒ½åˆ†ææœåŠ¡
â”‚   â”œâ”€â”€ retry.ts              # é‡è¯•æœºåˆ¶
â”‚   â”œâ”€â”€ auth.ts               # è®¤è¯æœåŠ¡
â”‚   â”œâ”€â”€ logger.ts             # æ—¥å¿—æœåŠ¡
â”‚   â”œâ”€â”€ metadata.ts           # å…ƒæ•°æ®ç®¡ç†
â”‚   â”œâ”€â”€ ai-gateway-enhancement.ts  # Gateway å¢å¼ºåŠŸèƒ½
â”‚   â””â”€â”€ providers/            # AI æä¾›å•†é€‚é…å™¨
â”‚       â”œâ”€â”€ openai.ts         # OpenAI é€‚é…å™¨
â”‚       â”œâ”€â”€ google-ai.ts      # Google AI é€‚é…å™¨  
â”‚       â”œâ”€â”€ workers-ai.ts     # Workers AI é€‚é…å™¨
â”‚       â”œâ”€â”€ anthropic.ts      # Anthropic é€‚é…å™¨
â”‚       â””â”€â”€ mock.ts           # å¼€å‘æµ‹è¯•é€‚é…å™¨
â”œâ”€â”€ capabilities/             # AI èƒ½åŠ›å¤„ç†å™¨
â”‚   â”œâ”€â”€ chat.ts               # èŠå¤©èƒ½åŠ›
â”‚   â”œâ”€â”€ embedding.ts          # åµŒå…¥èƒ½åŠ›
â”‚   â””â”€â”€ image.ts              # å›¾åƒèƒ½åŠ›
â”œâ”€â”€ config/
â”‚   â””â”€â”€ providers.ts          # æä¾›å•†é…ç½®
â””â”€â”€ prompts/
    â””â”€â”€ articleAnalysis.ts    # æ–‡ç« åˆ†ææç¤ºè¯æ¨¡æ¿
```

---

### ğŸ§© æ ¸å¿ƒç»„ä»¶

#### 1. **AI Gateway Service**
ä¸»è¦èŒè´£ï¼š
- ç»Ÿä¸€çš„ AI è¯·æ±‚å…¥å£
- æä¾›å•†é€‰æ‹©å’Œè·¯ç”±
- é”™è¯¯å¤„ç†å’Œé‡è¯•æœºåˆ¶
- å…ƒæ•°æ®æ”¶é›†å’Œç›‘æ§

#### 2. **Provider Adapters**
æ”¯æŒçš„AIæä¾›å•†ï¼š
- **OpenAI**: GPTç³»åˆ—ã€DALL-Eã€Embeddings
- **Google AI Studio**: Geminiç³»åˆ—
- **Cloudflare Workers AI**: å¼€æºæ¨¡å‹
- **Anthropic**: Claudeç³»åˆ—
- **Mock Provider**: å¼€å‘æµ‹è¯•

#### 3. **Capability Handlers**
AIèƒ½åŠ›æŠ½è±¡ï¼š
- **Chat**: å¯¹è¯èŠå¤©
- **Embedding**: å‘é‡åµŒå…¥ç”Ÿæˆ
- **Image**: å›¾åƒç”Ÿæˆ

---

### ğŸ”„ æ ¸å¿ƒAPIç«¯ç‚¹

#### Meridian ä¸“ç”¨ç«¯ç‚¹
```typescript
// æ–‡ç« åˆ†æ - æ ¸å¿ƒä¸šåŠ¡åŠŸèƒ½
POST /meridian/article/analyze
POST /meridian/analyze

// åµŒå…¥ç”Ÿæˆ - å‘é‡æ£€ç´¢æ”¯æŒ
POST /meridian/embeddings/generate

// é€šç”¨èŠå¤©æ¥å£
POST /meridian/chat
POST /meridian/chat/stream

// æ™ºèƒ½åˆ†æ
POST /meridian/intelligence/analyze-story

// æ•°æ®å¤„ç†
POST /meridian/articles/get-processed
POST /meridian/briefs/save
```

#### ç³»ç»Ÿç«¯ç‚¹
```typescript
// å¥åº·æ£€æŸ¥
GET /health

// åŸºç¡€æµ‹è¯•
GET /test
```

---

### ğŸ›¡ï¸ ä¼ä¸šçº§ç‰¹æ€§

#### 1. **å¯é æ€§**
- æ™ºèƒ½é‡è¯•æœºåˆ¶ï¼ˆæŒ‡æ•°é€€é¿ï¼‰
- æä¾›å•†æ•…éšœè½¬ç§»
- è¶…æ—¶æ§åˆ¶å’Œæ–­è·¯å™¨

#### 2. **å¯è§‚æµ‹æ€§**
- ç»“æ„åŒ–æ—¥å¿—è®°å½•
- è¯·æ±‚è¿½è¸ªå’Œå…ƒæ•°æ®æ”¶é›†
- æ€§èƒ½æŒ‡æ ‡ç›‘æ§

#### 3. **å®‰å…¨æ€§**
- API å¯†é’¥éªŒè¯
- CORS è·¨åŸŸæ§åˆ¶
- è¯·æ±‚ç­¾åéªŒè¯

#### 4. **æ€§èƒ½ä¼˜åŒ–**
- Cloudflare AI Gateway ç¼“å­˜
- è¾¹ç¼˜è®¡ç®—ä¼˜åŒ–
- æ™ºèƒ½ç¼“å­˜ç­–ç•¥

---

### âš™ï¸ é…ç½®ç®¡ç†

#### ç¯å¢ƒå˜é‡
```bash
# Cloudflare åŸºç¡€é…ç½®
CLOUDFLARE_ACCOUNT_ID
CLOUDFLARE_GATEWAY_ID  
CLOUDFLARE_API_TOKEN

# AI æä¾›å•†å¯†é’¥
OPENAI_API_KEY
ANTHROPIC_API_KEY
GOOGLE_AI_API_KEY
```

#### éƒ¨ç½²ç‰¹æ€§
- **é›¶åœæœºéƒ¨ç½²**: Cloudflare Workers è¾¹ç¼˜éƒ¨ç½²
- **å…¨çƒåˆ†å‘**: è‡ªåŠ¨è¾¹ç¼˜èŠ‚ç‚¹åˆ†å‘
- **å¼¹æ€§ä¼¸ç¼©**: è‡ªåŠ¨è´Ÿè½½å¤„ç†
- **æˆæœ¬æ•ˆç›Š**: æŒ‰ä½¿ç”¨é‡è®¡è´¹

---

### ğŸš€ æŠ€æœ¯ä¼˜åŠ¿

#### 1. **æ¶æ„ä¼˜åŠ¿**
- æ¨¡å—åŒ–è®¾è®¡ï¼Œæ¾è€¦åˆ
- å®Œæ•´çš„ TypeScript ç±»å‹å®‰å…¨
- æ¸…æ™°çš„èŒè´£åˆ†ç¦»
- æ˜“äºæµ‹è¯•å’Œç»´æŠ¤

#### 2. **æ€§èƒ½ä¼˜åŠ¿**
- è¾¹ç¼˜è®¡ç®—å»¶è¿Ÿä¼˜åŒ–
- æ™ºèƒ½ç¼“å­˜å‡å°‘é‡å¤è°ƒç”¨
- æ‰¹é‡å¤„ç†é™ä½æˆæœ¬
- è‡ªåŠ¨æ•…éšœè½¬ç§»ä¿è¯å¯ç”¨æ€§

#### 3. **è¿ç»´ä¼˜åŠ¿**
- ç»“æ„åŒ–æ—¥å¿—ä¾¿äºè°ƒè¯•
- å®Œæ•´çš„ç›‘æ§å’Œå‘Šè­¦
- ç®€åŒ–çš„éƒ¨ç½²æµç¨‹
- ç¯å¢ƒå˜é‡ç»Ÿä¸€ç®¡ç† 